# 1  实验内容

​    设计一个三层神经网络实现手写数字图像分类。该网络包含两个隐层和一个输出层，其中输入神经元个数由输入数据维度决定，输出层的神经元个数由数据集包含的类别决定，两个隐层的神经元个数可以作为超参数自行设置。对于手写数字图像的分类问题，输入数据为手写数字图像，原始图像一般可表示为二维矩阵（灰度图像）或三维矩阵（彩色图像），在输入神经网络前会将图像矩阵调整为一维向量作为输入。待分类的类别数一般是提前预设的，如手写数字包含0 至9 共10 个类别，则神经网络的输出神经元个数为10。为了便于迭代开发，工程实现时采用模块化的方式来实现整个神经网络的处理。目前绝大多数神经网络的工程实现通常划分为5大模块：

1) 数据加载模块：从文件中读取数据，并进行预处理，其中预处理包括归一化、维度变换等处理。如果需要人为对数据进行随机数据扩增，则数据扩增处理也在数据加载模块中实现。

2) 基本单元模块：实现神经网络中不同类型的网络层的定义、前向传播计算、反向传播计算等功能。

3) 网络结构模块：利用基本单元模块建立一个完整的神经网络。

4) 网络训练（training）模块：该模块实现用训练集进行神经网络训练的功能。在已建立的神经网络结构基础上，实现神经网络的前向传播、神经网络的反向传播、对神经网络进行参数更新、保存神经网络参数等基本操作，以及训练函数主体。

5) 网络推断（inference）模块：该模块实现使用训练得到的网络模型，对测试样本进行预测的过程。具体实现的操作包括训练得到的模型参数的加载、神经网络的前向传播等。

​    本实验即采用上述较为细致的模块划分方式。需要说明的是，目前有些开源的神经网络工程可能采用较粗的模块划分方式，例如将基本单元模块与网络结构模块合并，或将网络训练模块与网络推断模块合并。在某些特殊的应用场景下，神经网络工程还可能不需要包含所有模块，例如仅实现推断过程的工程中通常不包含训练模块（如实验3.1），非实时风格迁移工程中不包含推断模块.

# 2  实验环境

​    硬件环境：CPU。

​    软件环境：Python 编译环境及相关的扩展库，包括Python 2.7.12，Pillow 6.0.0，Scipy0.19.0，NumPy 1.16.0（本实验不需使用TensorFlow 等深度学习框架）。

​    数据集：MNIST 手写数字库[2]。该数据集包含一个训练集和一个测试集，其中训练集有60000 个样本，测试集有10000 个样本。每个样本都由灰度图像（即单通道图像）及其标记组成，图像大小为28 × 28。MNIST 数据集包含4 个文件，分别是训练集图像、训练集标记、测试集图像、测试集标记。



